apiVersion: apps/v1
kind: Deployment
metadata: { name: aegisai }
spec:
  replicas: 1
  selector: { matchLabels: { app: aegisai } }
  template:
    metadata: { labels: { app: aegisai } }
    spec:
      securityContext: { runAsNonRoot: true, seccompProfile: { type: RuntimeDefault } }
      containers:
      - name: api
        image: <REGISTRY>/aegisai-dev/aegisai:latest
        imagePullPolicy: IfNotPresent
        ports: [ { containerPort: 8000 } ]
        envFrom:
          - configMapRef: { name: aegisai-config }
          - secretRef: { name: aegisai-secrets }
        readinessProbe: { httpGet: { path: /healthz, port: 8000 }, initialDelaySeconds: 3, periodSeconds: 5 }
        livenessProbe:  { httpGet: { path: /healthz, port: 8000 }, initialDelaySeconds: 10, periodSeconds: 10 }
        resources:
          requests: { cpu: "100m", memory: "128Mi" }
          limits:   { cpu: "500m", memory: "512Mi" }
